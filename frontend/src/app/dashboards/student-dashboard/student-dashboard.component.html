<div class="student-dashboard" [class.sidebar-collapsed]="isSidebarCollapsed">
    <app-student-sidebar (collapsedChange)="onSidebarCollapseChanged($event)"></app-student-sidebar>
    
    <main class="main-content">
        <app-student-header [isSidebarCollapsed]="isSidebarCollapsed"></app-student-header>
        
        <div class="dashboard-content">
            <!-- Welcome Section -->
            <app-dashboard-card 
                title="Welcome back, {{ userName }}!" 
                subtitle="Here's your internship journey overview"
                cardClass="welcome-card"
                ariaLabel="Welcome section with user greeting">
                <div class="welcome-content">
                    <div class="welcome-text">
                        <p class="last-login" *ngIf="lastLogin">Last login: {{ lastLogin | date:'medium' }}</p>
                    </div>
                    <div class="welcome-actions">
                        <button class="btn-primary" routerLink="/browse-internships">
                            <i class="fas fa-search" aria-hidden="true"></i>
                            Find Internships
                        </button>
                    </div>
                </div>
            </app-dashboard-card>

            <!-- Loading State -->
            <div class="loading-container" *ngIf="loading" role="status" aria-live="polite">
                <div class="loading-spinner">
                    <i class="fas fa-spinner fa-spin" aria-hidden="true"></i>
                    <p>Loading your dashboard...</p>
                </div>
            </div>

            <!-- Stats Grid -->
            <div class="stats-section" *ngIf="!loading">
                <h2 class="section-title">Your Progress</h2>
                <div class="stats-grid">
                    <app-stat-card
                        [value]="studentStats.applications"
                        label="Applications Submitted"
                        icon="fas fa-file-alt"
                        iconColor="primary"
                        [change]="getChangeText('applications')"
                        [changeType]="getChangeType('applications')"
                        ariaLabel="Total applications submitted">
                    </app-stat-card>

                    <app-stat-card
                        [value]="studentStats.interviews"
                        label="Interviews Scheduled"
                        icon="fas fa-calendar-check"
                        iconColor="info"
                        [change]="getChangeText('interviews')"
                        [changeType]="getChangeType('interviews')"
                        ariaLabel="Interviews scheduled">
                    </app-stat-card>

                    <app-stat-card
                        [value]="studentStats.internships"
                        label="Active Internships"
                        icon="fas fa-briefcase"
                        iconColor="success"
                        [change]="getChangeText('internships')"
                        [changeType]="getChangeType('internships')"
                        ariaLabel="Active internships">
                    </app-stat-card>

                    <app-stat-card
                        [value]="studentStats.logbookEntries"
                        label="Logbook Entries"
                        icon="fas fa-book"
                        iconColor="warning"
                        [change]="getChangeText('logbookEntries')"
                        [changeType]="getChangeType('logbookEntries')"
                        ariaLabel="Logbook entries completed">
                    </app-stat-card>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="actions-section" *ngIf="!loading">
                <app-quick-actions
                    title="Quick Actions"
                    [actions]="quickActions"
                    [columns]="4"
                    layout="grid">
                </app-quick-actions>
            </div>

            <!-- Recent Activity -->
            <div class="activity-section" *ngIf="!loading">
                <app-dashboard-card 
                    title="Recent Activity" 
                    subtitle="Your latest internship activities"
                    ariaLabel="Recent activity feed">
                    <div class="activity-list" *ngIf="recentActivity.length > 0; else noActivity">
                        <div class="activity-item" *ngFor="let activity of recentActivity; trackBy: trackActivity">
                            <div class="activity-icon" [class]="activity.type">
                                <i [class]="activity.icon" aria-hidden="true"></i>
                            </div>
                            <div class="activity-content">
                                <p class="activity-text">{{ activity.text }}</p>
                                <span class="activity-time">{{ activity.timestamp | date:'short' }}</span>
                            </div>
                        </div>
                    </div>
                    <ng-template #noActivity>
                        <div class="empty-state">
                            <i class="fas fa-clock" aria-hidden="true"></i>
                            <p>No recent activity</p>
                            <small>Your internship activities will appear here</small>
                        </div>
                    </ng-template>
                </app-dashboard-card>
            </div>
        </div>
    </main>
</div>