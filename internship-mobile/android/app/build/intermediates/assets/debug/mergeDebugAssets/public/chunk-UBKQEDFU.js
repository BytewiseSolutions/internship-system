import{a as de}from"./chunk-ZI2MEB23.js";import{a as se,b as re,k as ae,m as le}from"./chunk-OSMB4DQJ.js";import{$ as H,A as b,B as f,Ca as oe,D as O,E as T,H as W,I as F,J as D,L as V,N,V as B,W as U,X as j,_ as A,c as L,ca as q,d as S,da as z,ea as G,fa as J,g as m,ga as K,h as p,ha as Q,i as d,j as x,k as I,ka as R,l as w,m as h,ma as X,n as o,na as Y,o as i,oa as Z,p as E,q as C,r as _,s as g,ta as $,ua as ee,v as r,va as te,w as P,x as u,ya as ie,z as k,za as ne}from"./chunk-6NGTZMOM.js";import"./chunk-447CKG3T.js";import"./chunk-CDZFCBFW.js";import"./chunk-E2CLONXR.js";import"./chunk-KRDHHS7Z.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-LRFGNCHE.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as M,b as v}from"./chunk-JHI3MBHO.js";var ce=(()=>{let l=class l{constructor(n){this.http=n,this.apiUrl="http://localhost:8000"}addLogbookEntry(n){return this.http.post(`${this.apiUrl}/logbook/add_logbook_entry.php`,n)}getStudentLogbook(n){return this.http.get(`${this.apiUrl}/logbook/get_student_logbook.php?user_id=${n}`)}updateLogbookEntry(n){return this.http.post(`${this.apiUrl}/logbook/update_logbook_entry.php`,n)}};l.\u0275fac=function(e){return new(e||l)(S(N))},l.\u0275prov=L({token:l,factory:l.\u0275fac,providedIn:"root"});let a=l;return a})();function pe(a,l){a&1&&(o(0,"div",12)(1,"p"),r(2,"Loading logbook entries..."),i()())}function _e(a,l){a&1&&(o(0,"div",13)(1,"p"),r(2,"No logbook entries yet."),i(),o(3,"p"),r(4,"Start recording your weekly activities!"),i()())}function ue(a,l){if(a&1&&(o(0,"div",18)(1,"p")(2,"strong"),r(3,"Supervisor Feedback:"),i()(),o(4,"p",19),r(5),i()()),a&2){let s=g().$implicit;d(5),P(s.supervisor_feedback)}}function he(a,l){if(a&1){let s=C();o(0,"ion-card",14)(1,"ion-card-header")(2,"ion-card-title"),r(3),i(),o(4,"ion-button",15),_("click",function(){let e=m(s).$implicit,t=g();return p(t.editEntry(e))}),E(5,"ion-icon",16),i()(),o(6,"ion-card-content")(7,"p")(8,"strong"),r(9,"Week Ending:"),i(),r(10),O(11,"date"),i(),o(12,"p")(13,"strong"),r(14,"Activities:"),i(),r(15),i(),o(16,"p")(17,"strong"),r(18,"Skills Learned:"),i(),r(19),i(),o(20,"p")(21,"strong"),r(22,"Challenges:"),i(),r(23),i(),w(24,ue,6,1,"div",17),i()()}if(a&2){let s=l.$implicit;d(3),u("Week ",s.week_number),d(7),u(" ",T(11,6,s.week_ending)),d(5),u(" ",s.activities_completed),d(4),u(" ",s.skills_learned),d(4),u(" ",s.challenges_faced),d(),h("ngIf",s.supervisor_feedback)}}function ke(a,l){if(a&1){let s=C();o(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),r(3),i(),o(4,"ion-buttons",20)(5,"ion-button",21),_("click",function(){m(s);let e=g();return p(e.closeModal())}),E(6,"ion-icon",22),i()()()(),o(7,"ion-content")(8,"div",23)(9,"ion-item")(10,"ion-label",24),r(11,"Week Number *"),i(),o(12,"ion-input",25),f("ngModelChange",function(e){m(s);let t=g();return b(t.weekNumber,e)||(t.weekNumber=e),p(e)}),i()(),o(13,"ion-item")(14,"ion-label",24),r(15,"Week Ending *"),i(),o(16,"ion-input",26),f("ngModelChange",function(e){m(s);let t=g();return b(t.weekEnding,e)||(t.weekEnding=e),p(e)}),i()(),o(17,"ion-item")(18,"ion-label",24),r(19,"Activities Completed *"),i(),o(20,"ion-textarea",27),f("ngModelChange",function(e){m(s);let t=g();return b(t.activitiesCompleted,e)||(t.activitiesCompleted=e),p(e)}),i()(),o(21,"ion-item")(22,"ion-label",24),r(23,"Skills Learned *"),i(),o(24,"ion-textarea",28),f("ngModelChange",function(e){m(s);let t=g();return b(t.skillsLearned,e)||(t.skillsLearned=e),p(e)}),i()(),o(25,"ion-item")(26,"ion-label",24),r(27,"Challenges Faced"),i(),o(28,"ion-textarea",29),f("ngModelChange",function(e){m(s);let t=g();return b(t.challengesFaced,e)||(t.challengesFaced=e),p(e)}),i()(),o(29,"div",30)(30,"ion-button",7),_("click",function(){m(s);let e=g();return p(e.saveEntry())}),r(31),i(),o(32,"ion-button",31),_("click",function(){m(s);let e=g();return p(e.closeModal())}),r(33," Cancel "),i()()()()}if(a&2){let s=g();d(3),u("",s.isEditing?"Edit":"Add"," Logbook Entry"),d(9),k("ngModel",s.weekNumber),d(4),k("ngModel",s.weekEnding),d(4),k("ngModel",s.activitiesCompleted),d(4),k("ngModel",s.skillsLearned),d(4),k("ngModel",s.challengesFaced),d(3),u(" ",s.isEditing?"Update":"Save"," Entry ")}}var Le=(()=>{let l=class l{constructor(n,e){this.logbookService=n,this.authService=e,this.logbookEntries=[],this.isLoading=!0,this.isModalOpen=!1,this.showToast=!1,this.toastMessage="",this.toastColor="success",this.weekNumber=1,this.weekEnding="",this.activitiesCompleted="",this.skillsLearned="",this.challengesFaced="",this.editingEntry=null,this.isEditing=!1,se({addOutline:re,closeOutline:ae,createOutline:le})}ngOnInit(){this.loadLogbookEntries(),this.setDefaultWeekEnding()}loadLogbookEntries(){let e=this.authService.getCurrentUser()?.id;e?this.logbookService.getStudentLogbook(e).subscribe({next:t=>{t.success?this.logbookEntries=t.entries||[]:this.logbookEntries=[],this.isLoading=!1},error:t=>{console.error("Error loading logbook:",t),this.logbookEntries=[],this.isLoading=!1}}):this.isLoading=!1}addEntry(){this.isEditing=!1,this.editingEntry=null,this.resetForm(),this.isModalOpen=!0}editEntry(n){this.isEditing=!0,this.editingEntry=n,this.weekNumber=n.week_number,this.weekEnding=n.week_ending,this.activitiesCompleted=n.activities_completed,this.skillsLearned=n.skills_learned,this.challengesFaced=n.challenges_faced||"",this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.resetForm()}saveEntry(){if(!this.weekEnding||!this.activitiesCompleted||!this.skillsLearned){this.showToastMessage("Please fill in all required fields","warning");return}let e=this.authService.getCurrentUser()?.id;if(!e){this.showToastMessage("User ID not found","danger");return}let t={user_id:e,week_number:this.weekNumber,week_ending:this.weekEnding,activities_completed:this.activitiesCompleted,skills_learned:this.skillsLearned,challenges_faced:this.challengesFaced};if(this.isEditing&&this.editingEntry){let c=v(M({},t),{logbook_id:this.editingEntry.logbook_id});this.logbookService.updateLogbookEntry(c).subscribe({next:y=>{y.success?(this.showToastMessage("Logbook entry updated successfully!","success"),this.loadLogbookEntries(),this.closeModal()):this.showToastMessage(y.message||"Failed to update entry","danger")},error:y=>{console.error("Error updating logbook entry:",y),this.showToastMessage("Network error. Please try again.","danger")}})}else this.logbookService.addLogbookEntry(t).subscribe({next:c=>{c.success?(this.showToastMessage("Logbook entry added successfully!","success"),this.loadLogbookEntries(),this.closeModal()):this.showToastMessage(c.message||"Failed to save entry","danger")},error:c=>{console.error("Error saving logbook entry:",c),this.showToastMessage("Network error. Please try again.","danger")}})}resetForm(){this.weekNumber=this.logbookEntries.length+1,this.weekEnding="",this.activitiesCompleted="",this.skillsLearned="",this.challengesFaced="",this.setDefaultWeekEnding()}setDefaultWeekEnding(){let n=new Date,t=(5-n.getDay()+7)%7,c=new Date(n);c.setDate(n.getDate()+t),this.weekEnding=c.toISOString().split("T")[0]}showToastMessage(n,e){this.toastMessage=n,this.toastColor=e,this.showToast=!0}};l.\u0275fac=function(e){return new(e||l)(x(ce),x(de))},l.\u0275cmp=I({type:l,selectors:[["app-logbook"]],decls:18,vars:8,consts:[["color","primary"],["slot","start"],["defaultHref","/my-internship"],[1,"logbook-content"],["class","loading-message",4,"ngIf"],["class","no-entries",4,"ngIf"],[1,"add-section"],["expand","block","color","primary",3,"click"],["name","add-outline","slot","start"],["class","entry-card",4,"ngFor","ngForOf"],[3,"didDismiss","isOpen"],[3,"didDismiss","isOpen","message","duration","color"],[1,"loading-message"],[1,"no-entries"],[1,"entry-card"],["fill","clear","size","small",1,"edit-button",3,"click"],["name","create-outline"],["class","supervisor-feedback",4,"ngIf"],[1,"supervisor-feedback"],[1,"feedback-text"],["slot","end"],[3,"click"],["name","close-outline"],[1,"modal-content"],["position","stacked"],["type","number","placeholder","1",3,"ngModelChange","ngModel"],["type","date",3,"ngModelChange","ngModel"],["placeholder","Describe what you accomplished this week...","rows","3",3,"ngModelChange","ngModel"],["placeholder","What new skills did you develop?","rows","3",3,"ngModelChange","ngModel"],["placeholder","Any difficulties or obstacles encountered?","rows","3",3,"ngModelChange","ngModel"],[1,"modal-buttons"],["expand","block","fill","outline",3,"click"]],template:function(e,t){e&1&&(o(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),E(3,"ion-back-button",2),i(),o(4,"ion-title"),r(5,"Logbook"),i()()(),o(6,"ion-content")(7,"div",3),w(8,pe,3,0,"div",4)(9,_e,5,0,"div",5),o(10,"div",6)(11,"ion-button",7),_("click",function(){return t.addEntry()}),E(12,"ion-icon",8),r(13," Add New Entry "),i()(),w(14,he,25,8,"ion-card",9),i(),o(15,"ion-modal",10),_("didDismiss",function(){return t.closeModal()}),w(16,ke,34,7,"ng-template"),i(),o(17,"ion-toast",11),_("didDismiss",function(){return t.showToast=!1}),i()()),e&2&&(d(8),h("ngIf",t.isLoading),d(),h("ngIf",!t.isLoading&&t.logbookEntries.length===0),d(5),h("ngForOf",t.logbookEntries),d(),h("isOpen",t.isModalOpen),d(2),h("isOpen",t.showToast)("message",t.toastMessage)("duration",3e3)("color",t.toastColor))},dependencies:[V,W,F,j,B,U,X,te,$,R,G,K,Q,J,q,ie,A,z,H,Y,Z,ne,oe,ee,D],styles:[".logbook-content[_ngcontent-%COMP%]{padding:1rem}.loading-message[_ngcontent-%COMP%], .no-entries[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#666}.add-section[_ngcontent-%COMP%]{margin-bottom:1rem}.add-section[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 12px;font-weight:600}.entry-card[_ngcontent-%COMP%]{margin-bottom:1rem;border-radius:12px;box-shadow:0 2px 8px #0000001a}.entry-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.entry-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{color:#2e7d32;font-weight:600;flex:1}.edit-button[_ngcontent-%COMP%]{--color: #2e7d32;margin:0}.modal-content[_ngcontent-%COMP%]{padding:1rem}.modal-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;margin-bottom:1rem}.modal-buttons[_ngcontent-%COMP%]{padding:1rem 0;display:flex;flex-direction:column;gap:.5rem}.modal-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 12px;font-weight:600}.supervisor-feedback[_ngcontent-%COMP%]{margin-top:1rem;padding:.75rem;background-color:#f8f9fa;border-left:4px solid #2e7d32;border-radius:4px}.feedback-text[_ngcontent-%COMP%]{font-style:italic;color:#555;margin:.5rem 0 0}"]});let a=l;return a})();export{Le as LogbookPage};
